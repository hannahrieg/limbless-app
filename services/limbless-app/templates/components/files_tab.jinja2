{% macro files_tab(context, files, delete_url, delete_context) -%}
<div class="page-header">
    <div>
        <h2>Files</h2>
    </div>
</div>
<ul class="nav nav-tabs" role="tablist">
    {% for file in files %}
    <li class="nav-item" role="presentation">
        <button class="nav-link {% if loop.index0 == 0 %}active{% endif %}" data-bs-toggle="tab"
        data-bs-target="#{{context}}-file-{{ file.id }}-tab" type="button" role="tab"
        aria-controls="{{context}}-file-{{ file.id }}-tab" aria-selected="true">
        {{ file.type.name if file.type.name != "Custom" else file.name }}</button>
    </li>
    {% endfor %}
</ul>
<div class="tab-content pt-3">
    {% for file in files %}
    <div class="tab-pane fade show {% if loop.index0 == 0 %}active{% endif %}" id="{{context}}-file-{{ file.id }}-tab" role="tabpanel" tabindex="{{ loop.index }}">
        <div class="d-flex justify-content-between align-items-center pt-3 pb-1">
            <div>
                <h4>{{ file.name }}</h4>
            </div>
            <div>
                {% if file.type.name != "Sequencing Authorization Form" %}
                <a type="button" class="btn btn-danger"
                hx-delete="{{ url_for(delete_url, file_id=file.id, **delete_context) }}"
                _="on htmx:confirm(issueRequest)
                halt the event
                call Swal.fire({
                    title: 'Delete file \'{{ file.name }}\'',
                    showDenyButton: true,
                    text: 'Are you sure?',
                    confirmButtonText: 'Yes',
                    denyButtonText: 'No'
                })
                if result.isConfirmed issueRequest()">
                    Delete File
                </a>
                {% endif %}
            </div>
        </div>
        {% if file.extension == ".pdf" %}
        <embed src="{{ url_for('pdf_file',  file_id=file.id) }}" type="application/pdf" width="100%" height="1000px"/>
        {% elif file.extension in [".png", ".jpg", ".jpeg"] %}
        <img src="{{ url_for('img_file',  file_id=file.id) }}" class="img-fluid" alt="{{file.name}}" style="width: 100%;" loading="lazy">
        {% else %}
        <h4>File type {{file.extension}} not supported yet.</h4>
        {% endif %}
    </div>
    {% endfor %}
</div>
{%- endmacro %}